<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>3D Timelapse Models with Videos</title>

<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

<style>
  body {
    font-family: sans-serif;
    margin: 20px;
    text-align: center;
    background: #fafafa;
  }

  h1 {
    margin-bottom: 15px;
  }

  .category-buttons,
  .timepoint-buttons,
  .dose-buttons {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    margin-bottom: 15px;
  }

  .label {
    font-weight: bold;
    margin: 18px 0 8px;
  }

  button {
    margin: 6px;
    padding: 12px 18px;
    font-size: 1rem;
    border-radius: 6px;
    border: 2px solid #bbb;
    background-color: #e6e6e6;
    color: #222;
    cursor: pointer;
  }

  button.active {
    background-color: #2563eb; /* blue */
    color: white;
    border-color: #2563eb;
  }

  model-viewer {
    width: 90vw;
    max-width: 800px;
    height: 600px;
    margin: 20px auto;
    background: #f0f0f0;
    border-radius: 10px;
  }

  .video-container {
    width: 90vw;
    max-width: 450px;
    aspect-ratio: 1 / 1;
    margin: 20px auto;
    display: none;
  }

  .video-container iframe {
    width: 100%;
    height: 100%;
    border-radius: 10px;
  }

  @media (max-width: 768px) {
    model-viewer {
      height: 400px;
    }

    button {
      padding: 14px 20px;
      font-size: 1.05rem;
    }
  }
</style>
</head>

<body>

<h1>3D Timelapse Models with Videos</h1>

<!-- CATEGORY -->
<div class="category-buttons">
  <button id="cisBtn">Cisplatin Treated</button>
  <button id="ctrlBtn">Control Examples</button>
</div>

<!-- CISPLATIN -->
<div id="cisplatin-section">

  <div class="label">Timepoint</div>
  <div class="timepoint-buttons" id="timepoint-buttons"></div>

  <div class="label">Dose</div>
  <div class="dose-buttons" id="dose-buttons"></div>

  <model-viewer
    id="viewer"
    camera-controls
    auto-rotate>
  </model-viewer>

  <!-- VIDEOS -->
  <div id="video0-1" class="video-container"><iframe src="https://www.youtube.com/embed/PPgnb7jVyTw" allowfullscreen></iframe></div>
  <div id="video0-2" class="video-container"><iframe src="https://www.youtube.com/embed/V-o-g-r7VAw" allowfullscreen></iframe></div>
  <div id="video0-3" class="video-container"><iframe src="https://www.youtube.com/embed/vyoOUdkt2g4" allowfullscreen></iframe></div>

  <div id="video6-1" class="video-container"><iframe src="https://www.youtube.com/embed/0tYk-JrA_eU" allowfullscreen></iframe></div>
  <div id="video6-2" class="video-container"><iframe src="https://www.youtube.com/embed/7HaoWD1l95Q" allowfullscreen></iframe></div>
  <div id="video6-3" class="video-container"><iframe src="https://www.youtube.com/embed/SXqw-uGKpcs" allowfullscreen></iframe></div>

  <div id="video1" class="video-container"><iframe src="https://www.youtube.com/embed/rIRaMQCrBYU" allowfullscreen></iframe></div>
  <div id="video2" class="video-container"><iframe src="https://www.youtube.com/embed/E14wngHJKH4" allowfullscreen></iframe></div>
  <div id="video3" class="video-container"><iframe src="https://www.youtube.com/embed/J3KHXilgRpw" allowfullscreen></iframe></div>

</div>

<!-- CONTROL -->
<div id="control-section" style="display:none;">
  <div id="control-videos"></div>
</div>

<script>
  const viewer = document.getElementById('viewer');
  const cisSection = document.getElementById('cisplatin-section');
  const ctrlSection = document.getElementById('control-section');

  const cisBtn = document.getElementById('cisBtn');
  const ctrlBtn = document.getElementById('ctrlBtn');

  const tpButtonsDiv = document.getElementById('timepoint-buttons');
  const doseButtonsDiv = document.getElementById('dose-buttons');

  const timepoints = {
    "0HR": [
      { src: "models/0HR_30cis_timelapse_z.glb", label: "30 µM", video: "video0-1" },
      { src: "models/0HR_100cis_timelapse_z.glb", label: "100 µM", video: "video0-2" },
      { src: "models/0HR_300cis_timelapse_z.glb", label: "300 µM", video: "video0-3" }
    ],
    "6HR": [
      { src: "models/6HR_30cis_timelapse_z.glb", label: "30 µM", video: "video6-1" },
      { src: "models/6HR_100cis_timelapse_z.glb", label: "100 µM", video: "video6-2" },
      { src: "models/6HR_300cis_timelapse_z.glb", label: "300 µM", video: "video6-3" }
    ],
    "24HR": [
      { src: "models/24HR_30cis_timelapse_z.glb", label: "30 µM", video: "video1" },
      { src: "models/24HR_100cis_timelapse_z.glb", label: "100 µM", video: "video2" },
      { src: "models/24HR_300cis_timelapse_z.glb", label: "300 µM", video: "video3" }
    ]
  };

  let currentTimepoint = "0HR"; // START AT 0HR

  // CATEGORY BUTTONS
  cisBtn.onclick = () => {
    cisSection.style.display = "block";
    ctrlSection.style.display = "none";
    cisBtn.classList.add("active");
    ctrlBtn.classList.remove("active");
  };

  ctrlBtn.onclick = () => {
    cisSection.style.display = "none";
    ctrlSection.style.display = "block";
    cisBtn.classList.remove("active");
    ctrlBtn.classList.add("active");

    const container = document.getElementById("control-videos");
    if (!container.hasChildNodes()) {
      container.innerHTML = `
        <div class="video-container" style="display:block;">
          <iframe src="https://www.youtube.com/embed/Bl_DnE48yRM" allowfullscreen></iframe>
        </div>
        <div class="video-container" style="display:block;">
          <iframe src="https://www.youtube.com/embed/DldJT74aJJ4" allowfullscreen></iframe>
        </div>
      `;
    }
  };

  // TIMEPOINT BUTTONS
  Object.keys(timepoints).forEach(tp => {
    const btn = document.createElement("button");
    btn.textContent = tp;

    btn.onclick = () => {
      document.querySelectorAll(".timepoint-buttons button")
        .forEach(b => b.classList.remove("active"));
      btn.classList.add("active");
      currentTimepoint = tp;
      renderDoseButtons();
    };

    tpButtonsDiv.appendChild(btn);
  });

  function renderDoseButtons() {
    doseButtonsDiv.innerHTML = "";

    timepoints[currentTimepoint].forEach((m, i) => {
      const btn = document.createElement("button");
      btn.textContent = m.label;

      btn.onclick = () => {
        document.querySelectorAll(".dose-buttons button")
          .forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        setModel(m.src, m.video);
      };

      if (i === 0) btn.classList.add("active"); // first dose active
      doseButtonsDiv.appendChild(btn);
    });

    // Show first model and video by default
    setModel(timepoints[currentTimepoint][0].src, timepoints[currentTimepoint][0].video);
  }

  function setModel(src, videoId) {
    viewer.src = src;
    document.querySelectorAll(".video-container")
      .forEach(v => v.style.display = "none");
    document.getElementById(videoId).style.display = "block";
  }

  // INITIAL STATE
  cisBtn.classList.add("active");
  tpButtonsDiv.querySelector("button:first-child").classList.add("active"); // 0HR active
  renderDoseButtons();
</script>

</body>
</html>
